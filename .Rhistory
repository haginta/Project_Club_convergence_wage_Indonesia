library(ConvergenceClubs)
library(tidyverse)
library(janitor)
library(tibble)
library(readxl)
nominal.wage <- read_excel("WS Labour_new.xlsx",
sheet = "nominal_wage_B")
nominal.wage
nominal.wage <- nominal.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
nominal.wage.log <- log(nominal.wage[,-1])
nominal.wage.log
f.nominal.wage.log <- apply(nominal.wage.log, 1,
function(x){mFilter::hpfilter(x, freq=6.25, type="lambda")$trend} )
f.nominal.wage.log <- data.frame(Province = nominal.wage[,1], t(f.nominal.wage.log), stringsAsFactors=FALSE )
colnames(f.nominal.wage.log) <- colnames(nominal.wage)
head(f.nominal.wage.log)
H.nominal <- computeH(f.nominal.wage.log[,-1], quantity = "H")
round(estimateMod(H.nominal, time_trim=0.333, HACmethod = "FQSB"), 3)
clubs.nominal <- findClubs(f.nominal.wage.log, dataCols=2:14, unit_names = 1, refCol=14,
time_trim=0.333, cstar=0, HACmethod = 'FQSB')
summary(clubs.nominal)
print(clubs.nominal)
plot(clubs.nominal)
plot(clubs.nominal, clubs=NULL, avgTP = TRUE, legend=TRUE)
mclubs.nominal <- mergeClubs(clubs.nominal, mergeMethod='PS')
summary(mclubs.nominal)
mclubs.nominal
plot(mclubs.nominal)
plot(mclubs.nominal, clubs=NULL, avgTP = TRUE, legend=TRUE)
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_B")
real.wage
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.log <- log(real.wage[,-1])
real.wage.log
f.real.wage.log <- apply(real.wage.log, 1,
function(x){mFilter::hpfilter(x, freq=6.25, type="lambda")$trend} )
f.real.wage.log <- data.frame(Province = real.wage[,1], t(f.real.wage.log), stringsAsFactors=FALSE )
colnames(f.real.wage.log) <- colnames(real.wage)
head(f.real.wage.log)
H.real <- computeH(f.real.wage.log[,-1], quantity = "H")
round(estimateMod(H.real, time_trim=0.333, HACmethod = "FQSB"), 3)
clubs.real <- findClubs(f.real.wage.log, dataCols=2:14, unit_names = 1, refCol=14,
time_trim=0.333, cstar=0, HACmethod = 'FQSB')
summary(clubs.real)
print(clubs.real)
plot(clubs.real)
plot(clubs.real, clubs=NULL, avgTP = TRUE, legend=TRUE)
mclubs.real <- mergeClubs(clubs.real, mergeMethod='PS')
summary(mclubs.real)
mclubs.real
plot(mclubs.real)
plot(mclubs.real, clubs=NULL, avgTP = TRUE, legend=TRUE)
library(ConvergenceClubs)
library(tidyverse)
library(janitor)
library(tibble)
library(readxl)
nominal.wage <- read_excel("WS Labour_new.xlsx",
sheet = "nominal_wage_A")
nominal.wage
nominal.wage <- nominal.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
nominal.wage.log <- log(nominal.wage[,-1])
nominal.wage.log
f.nominal.wage.log <- apply(nominal.wage.log, 1,
function(x){mFilter::hpfilter(x, freq=6.25, type="lambda")$trend} )
f.nominal.wage.log <- data.frame(Province = nominal.wage[,1], t(f.nominal.wage.log), stringsAsFactors=FALSE )
colnames(f.nominal.wage.log) <- colnames(nominal.wage)
head(f.nominal.wage.log)
H.nominal <- computeH(f.nominal.wage.log[,-1], quantity = "H")
round(estimateMod(H.nominal, time_trim=0.333, HACmethod = "FQSB"), 3)
clubs.nominal <- findClubs(f.nominal.wage.log, dataCols=2:14, unit_names = 1, refCol=14,
time_trim=0.333, cstar=0, HACmethod = 'FQSB')
summary(clubs.nominal)
print(clubs.nominal)
plot(clubs.nominal)
plot(clubs.nominal, clubs=NULL, avgTP = TRUE, legend=TRUE)
mclubs.nominal <- mergeClubs(clubs.nominal, mergeMethod='PS')
summary(mclubs.nominal)
mclubs.nominal
plot(mclubs.nominal)
plot(mclubs.nominal, clubs=NULL, avgTP = TRUE, legend=TRUE)
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.log <- log(real.wage[,-1])
real.wage.log
f.real.wage.log <- apply(real.wage.log, 1,
function(x){mFilter::hpfilter(x, freq=6.25, type="lambda")$trend} )
f.real.wage.log <- data.frame(Province = real.wage[,1], t(f.real.wage.log), stringsAsFactors=FALSE )
colnames(f.real.wage.log) <- colnames(real.wage)
head(f.real.wage.log)
H.real <- computeH(f.real.wage.log[,-1], quantity = "H")
round(estimateMod(H.real, time_trim=0.333, HACmethod = "FQSB"), 3)
clubs.real <- findClubs(f.real.wage.log, dataCols=2:14, unit_names = 1, refCol=14,
time_trim=0.333, cstar=0, HACmethod = 'FQSB')
summary(clubs.real)
print(clubs.real)
plot(clubs.real)
plot(clubs.real, clubs=NULL, avgTP = TRUE, legend=TRUE)
mclubs.real <- mergeClubs(clubs.real, mergeMethod='PS')
summary(mclubs.real)
mclubs.real
plot(mclubs.real)
plot(mclubs.real, clubs=NULL, avgTP = TRUE, legend=TRUE)
class(mclubs.nominal)
table.mclubs.nom <- map(mclubs.nominal, as.data.table)
table.mclubs.nom <- map(mclubs.nominal, as.data.table)
library(ConvergenceClubs)
library(tidyverse)
library(janitor)
library(tibble)
library(data.table)
library(readxl)
nominal.wage <- read_excel("WS Labour_new.xlsx",
sheet = "nominal_wage_A")
nominal.wage
nominal.wage <- nominal.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
nominal.wage.log <- log(nominal.wage[,-1])
nominal.wage.log
f.nominal.wage.log <- apply(nominal.wage.log, 1,
function(x){mFilter::hpfilter(x, freq=6.25, type="lambda")$trend} )
f.nominal.wage.log <- data.frame(Province = nominal.wage[,1], t(f.nominal.wage.log), stringsAsFactors=FALSE )
colnames(f.nominal.wage.log) <- colnames(nominal.wage)
head(f.nominal.wage.log)
H.nominal <- computeH(f.nominal.wage.log[,-1], quantity = "H")
round(estimateMod(H.nominal, time_trim=0.333, HACmethod = "FQSB"), 3)
clubs.nominal <- findClubs(f.nominal.wage.log, dataCols=2:14, unit_names = 1, refCol=14,
time_trim=0.333, cstar=0, HACmethod = 'FQSB')
summary(clubs.nominal)
print(clubs.nominal)
plot(clubs.nominal)
plot(clubs.nominal, clubs=NULL, avgTP = TRUE, legend=TRUE)
mclubs.nominal <- mergeClubs(clubs.nominal, mergeMethod='PS')
summary(mclubs.nominal)
mclubs.nominal
plot(mclubs.nominal)
plot(mclubs.nominal, clubs=NULL, avgTP = TRUE, legend=TRUE)
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.log <- log(real.wage[,-1])
real.wage.log
f.real.wage.log <- apply(real.wage.log, 1,
function(x){mFilter::hpfilter(x, freq=6.25, type="lambda")$trend} )
f.real.wage.log <- data.frame(Province = real.wage[,1], t(f.real.wage.log), stringsAsFactors=FALSE )
colnames(f.real.wage.log) <- colnames(real.wage)
head(f.real.wage.log)
H.real <- computeH(f.real.wage.log[,-1], quantity = "H")
round(estimateMod(H.real, time_trim=0.333, HACmethod = "FQSB"), 3)
clubs.real <- findClubs(f.real.wage.log, dataCols=2:14, unit_names = 1, refCol=14,
time_trim=0.333, cstar=0, HACmethod = 'FQSB')
summary(clubs.real)
print(clubs.real)
plot(clubs.real)
plot(clubs.real, clubs=NULL, avgTP = TRUE, legend=TRUE)
mclubs.real <- mergeClubs(clubs.real, mergeMethod='PS')
summary(mclubs.real)
mclubs.real
plot(mclubs.real)
plot(mclubs.real, clubs=NULL, avgTP = TRUE, legend=TRUE)
class(mclubs.nominal)
table.mclubs.nom <- map(mclubs.nominal, as.data.table)
df.mclubs.nom <- rbindlist(table.mclubs.nom, fill = T, idcol = T)
df.mclubs.nom
colnames(df.mclubs.nom)[5] <- "Province"
df.mclubs.nom
nominal.wage.club <- as.data.frame(
inner_join(f.nominal.wage.log, df.mclubs.nom, by="Province") %>%
select(-contains(c("id","model")))
)
nominal.wage.club
relative <- list()
for(a in 2:14) {
relative[[a]] <- data.frame(nominal.wage.club$Province, nominal.wage.club[,a]/mean(nominal.wage.club[,a]))
colnames(relative[[a]])[1]<- "Province"
colnames(relative[[a]])[2]<-
paste("rel",colnames(nominal.wage.club)[a],sep="_")
}
for (x in 2:13) {
relative[[x+1]]<-left_join(relative[[x]],relative[[x+1]], by="Province")
}
table.relative <- map(relative, as.data.table)
df.relative <- rbindlist(table.relative, fill = T, idcol = T) %>% drop_na()
library(plyr)
df.relative <- join(df.relative,nominal.wage.club,by=c('Province')) %>%
select(Province,contains("rel"),clubs)
df.relative <- as.data.frame(df.relative)
colnames(df.relative) <- gsub("rel_","",colnames(df.relative))
df.relative
df.relative.long <- df.relative %>%  pivot_longer(-c(Province,clubs), names_to = "Time", values_to="Rel_Wage")
df.relative.long
df.relative.path <- aggregate(Rel_Wage ~ clubs + Time, df.relative.long, mean) %>%
arrange(clubs)
path_all <- df.relative.path %>%
ggplot(aes(x=Time,y=Rel_Wage, group=clubs, col=clubs)) + geom_line() +
labs(title = "Transition path of all clubs") +
theme_bw()
path_all
club1 <- nominal.wage.club %>%
filter(clubs == "club1")
relative.club1 <- list()
for(a in 2:14) {
relative.club1[[a]] <- data.frame(club1$Province, club1[,a]/mean(club1[,a]))
colnames(relative.club1[[a]])[1]<- "Province"
colnames(relative.club1[[a]])[2]<-
paste("rel",colnames(club1)[a],sep="_")
}
for (x in 2:13) {
relative.club1[[x+1]]<-left_join(relative.club1[[x]],relative.club1[[x+1]], by="Province")
}
table.relative.club1 <- map(relative.club1, as.data.table)
df.relative.club1 <- rbindlist(table.relative.club1, fill = T, idcol = T) %>% drop_na()
library(plyr)
df.relative.club1 <- join(df.relative.club1,club1,by=c('Province')) %>%
select(Province,contains("rel"),clubs)
df.relative.club1
colnames(df.relative.club1) <- gsub("rel_","",colnames(df.relative.club1))
df.relative.club1
df.relative.club1.long <- df.relative.club1 %>%  pivot_longer(-c(Province,clubs), names_to = "Time", values_to="Rel_Wage")
df.relative.club1.long
df.relative.club1.path <- aggregate(Rel_Wage ~ Province + Time, df.relative.club1.long, mean) %>%
arrange(Province)
path_club1 <- df.relative.club1.path %>%
ggplot(aes(x=Time,y=Rel_Wage, group=Province, col=Province)) + geom_line() +
labs(title = "Transition path of regions in Club 1") +
theme_bw() +
theme(legend.title = element_text(size = 8),
legend.text = element_text(size = 8))
path_club1
club2 <- nominal.wage.club %>%
filter(clubs == "club2")
relative.club2 <- list()
for(a in 2:14) {
relative.club2[[a]] <- data.frame(club2$Province, club2[,a]/mean(club2[,a]))
colnames(relative.club2[[a]])[1]<- "Province"
colnames(relative.club2[[a]])[2]<-
paste("rel",colnames(club2)[a],sep="_")
}
for (x in 2:13) {
relative.club2[[x+1]]<-left_join(relative.club2[[x]],relative.club2[[x+1]], by="Province")
}
table.relative.club2 <- map(relative.club2, as.data.table)
df.relative.club2 <- rbindlist(table.relative.club2, fill = T, idcol = T) %>% drop_na()
library(plyr)
df.relative.club2 <- join(df.relative.club2,club2,by=c('Province')) %>%
select(Province,contains("rel"),clubs)
df.relative.club2
colnames(df.relative.club2) <- gsub("rel_","",colnames(df.relative.club2))
df.relative.club2
df.relative.club2.long <- df.relative.club2 %>%  pivot_longer(-c(Province,clubs), names_to = "Time", values_to="Rel_Wage")
df.relative.club2.long
df.relative.club2.path <- aggregate(Rel_Wage ~ Province + Time, df.relative.club2.long, mean) %>%
arrange(Province)
path_club2 <- df.relative.club2.path %>%
ggplot(aes(x=Time,y=Rel_Wage, group=Province, col=Province)) + geom_line() +
labs(title = "Transition path of regions in Club 2") +
theme_bw() +
theme(legend.title = element_text(size = 7),
legend.text = element_text(size = 7))
path_club2
path_club2 <- df.relative.club2.path %>%
ggplot(aes(x=Time,y=Rel_Wage, group=Province, col=Province)) + geom_line() +
labs(title = "Transition path of regions in Club 2") +
theme_bw() +
theme(legend.title = element_text(size = 7),
legend.text = element_text(size = 7))
path_club2
ggsave("path_club2.png")
