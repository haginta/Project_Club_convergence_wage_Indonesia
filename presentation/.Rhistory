theme_classic() + theme(axis.text.x=element_text(angle=90))
p
p <- p + guides(fill=guide_legend(title="New Legend Title"))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90))
ggsave("wage_quantile.png", width = 9, height = 5)
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
library(ConvergenceClubs)
library(tidyverse)
library(janitor)
library(tibble)
library(data.table)
library(ExPanDaR)
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
real.wage.long <- as.data.frame(real.wage.long)
real.wage.long$Year <- as.Date(as.factor(real.wage.long$Year), format = "%Y")
real.wage.long$Year <- as.factor(as.numeric(real.wage.long$Year))
f.real.wage.log <- apply(real.wage.log, 1,
function(x){mFilter::hpfilter(x, freq=6.25, type="lambda")$trend} )
real.wage.log <- log(real.wage[,-1])
real.wage.log
f.real.wage.log <- apply(real.wage.log, 1,
function(x){mFilter::hpfilter(x, freq=6.25, type="lambda")$trend} )
f.real.wage.log <- data.frame(Province = real.wage[,1], t(f.real.wage.log), stringsAsFactors=FALSE )
colnames(f.real.wage.log) <- colnames(real.wage)
head(f.real.wage.log)
H.real <- computeH(f.real.wage.log[,-1], quantity = "H")
round(estimateMod(H.real, time_trim=0.333, HACmethod = "FQSB"), 3)
clubs.real <- findClubs(f.real.wage.log, dataCols=2:14, unit_names = 1, refCol=14,
time_trim=0.333, cstar=0, HACmethod = 'FQSB')
summary(clubs.real)
mclubs.real <- mergeClubs(clubs.real, mergeMethod='PS')
summary(mclubs.real)
table.mclubs.real <- map(mclubs.real, as.data.table)
df.mclubs.real <- rbindlist(table.mclubs.real, fill = T, idcol = T)
df.mclubs.real
colnames(df.mclubs.real)[c(1,5)] <- c("Club","Province")
df.mclubs.real
real.wage.club <- as.data.frame(
inner_join(f.real.wage.log, df.mclubs.real, by="Province") %>%
select(-contains(c("clubs","id","model")))
)
real.wage.club
real.wage.club$Club <- gsub("club", "Club ", real.wage.club$Club)
real.wage.club
relative.real <- list()
for(a in 2:14) {
relative.real[[a]] <- data.frame(real.wage.club$Province, real.wage.club[,a]/mean(real.wage.club[,a]))
colnames(relative.real[[a]])[1]<- "Province"
colnames(relative.real[[a]])[2]<-
paste("rel",colnames(real.wage.club)[a],sep="_")
}
for (x in 2:13) {
relative.real[[x+1]]<-left_join(relative.real[[x]],relative.real[[x+1]], by="Province")
}
table.relative.real <- map(relative.real, as.data.table)
df.relative.real <- rbindlist(table.relative.real, fill = T, idcol = T) %>% drop_na()
library(plyr)
df.relative.real <- join(df.relative.real,real.wage.club,by=c('Province')) %>%
select(Province,contains("rel"),Club)
df.relative.real <- as.data.frame(df.relative.real)
colnames(df.relative.real) <- gsub("rel_","",colnames(df.relative.real))
df.relative.real
df.relative.real.long <- df.relative.real %>%  pivot_longer(-c(Province,Club), names_to = "Time", values_to="Rel_Wage")
df.relative.real.long
df.relative.real.path <- aggregate(Rel_Wage ~ Club + Time, df.relative.real.long, mean) %>%
arrange(Club)
path_all.real <- df.relative.real.path %>%
ggplot(aes(x=Time,y=Rel_Wage, group=Club, col=Club)) + geom_line() +
labs(x = "Time",
y = "Relative transition paths of all clubs", color="") +
theme(text=element_text( family="Palatino")) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
path_all.real
ggsave("path_all.real.png", width = 9, height = 5)
club1.real <- real.wage.club %>%
filter(Club == "Club 1")
relative.club1.real <- list()
for(a in 2:14) {
relative.club1.real[[a]] <- data.frame(club1.real$Province, club1.real[,a]/mean(club1.real[,a]))
colnames(relative.club1.real[[a]])[1]<- "Province"
colnames(relative.club1.real[[a]])[2]<-
paste("rel",colnames(club1.real)[a],sep="_")
}
for (x in 2:13) {
relative.club1.real[[x+1]]<-left_join(relative.club1.real[[x]],relative.club1.real[[x+1]], by="Province")
}
table.relative.club1.real <- map(relative.club1.real, as.data.table)
df.relative.club1.real <- rbindlist(table.relative.club1.real, fill = T, idcol = T) %>% drop_na()
library(plyr)
df.relative.club1.real <- join(df.relative.club1.real,club1.real,by=c('Province')) %>%
select(Province,contains("rel"),Club)
df.relative.club1.real
colnames(df.relative.club1.real) <- gsub("rel_","",colnames(df.relative.club1.real))
df.relative.club1.real
df.relative.club1.real.long <- df.relative.club1.real %>%  pivot_longer(-c(Province,Club), names_to = "Time", values_to="Rel_Wage")
df.relative.club1.real.long
df.relative.club1.real.path <- aggregate(Rel_Wage ~ Province + Time, df.relative.club1.real.long, mean) %>%
arrange(Province)
a <- path_club1.real <- df.relative.club1.real.path %>%
ggplot(aes(x=Time,y=Rel_Wage, group=Province, col=Province)) + geom_line() +
labs(x = "Time",
y = "Relative transition paths of provinces in Club 1", color="") +
theme(text=element_text( family="Palatino")) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
path_club1.real
#ggsave("path_club1.real.png", width = 9, height = 5)
club2.real <- real.wage.club %>%
filter(Club == "Club 2")
relative.club2.real <- list()
for(a in 2:14) {
relative.club2.real[[a]] <- data.frame(club2.real$Province, club2.real[,a]/mean(club2.real[,a]))
colnames(relative.club2.real[[a]])[1]<- "Province"
colnames(relative.club2.real[[a]])[2]<-
paste("rel",colnames(club2.real)[a],sep="_")
}
for (x in 2:13) {
relative.club2.real[[x+1]]<-left_join(relative.club2.real[[x]],relative.club2.real[[x+1]], by="Province")
}
table.relative.club2.real <- map(relative.club2.real, as.data.table)
df.relative.club2.real <- rbindlist(table.relative.club2.real, fill = T, idcol = T) %>% drop_na()
library(plyr)
df.relative.club2.real <- join(df.relative.club2.real,club2.real,by=c('Province')) %>%
select(Province,contains("rel"),Club)
df.relative.club2.real
colnames(df.relative.club2.real) <- gsub("rel_","",colnames(df.relative.club2.real))
df.relative.club2.real
df.relative.club2.real.long <- df.relative.club2.real %>%  pivot_longer(-c(Province,Club), names_to = "Time", values_to="Rel_Wage")
df.relative.club2.real.long
df.relative.club2.real.path <- aggregate(Rel_Wage ~ Province + Time, df.relative.club2.real.long, mean) %>%
arrange(Province)
b<-path_club2.real <- df.relative.club2.real.path %>%
ggplot(aes(x=Time,y=Rel_Wage, group=Province, col=Province)) + geom_line() +
labs(x = "Time",
y = "Relative transition paths of provinces in Club 2", color="") +
theme(text=element_text( family="Palatino")) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
path_club2.real
#ggsave("path_club2.real.png", width = 9, height = 5)
ggplotly(b)
library(ggplotly)
library(plotly)
ggplotly(b)
b<-path_club2.real <- df.relative.club2.real.path %>%
ggplot(aes(x=Time,y=Rel_Wage, group=Province, col=Province)) + geom_line() +
labs(x = "Time",
y = "Relative transition paths of provinces in Club 2", color="") +
theme(text=element_text( family="Palatino")) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
path_club2.real
ggsave("path_club2.real.png", width = 9, height = 5)
club3.real <- real.wage.club %>%
filter(Club == "Club 3")
relative.club3.real <- list()
for(a in 2:14) {
relative.club3.real[[a]] <- data.frame(club3.real$Province, club3.real[,a]/mean(club3.real[,a]))
colnames(relative.club3.real[[a]])[1]<- "Province"
colnames(relative.club3.real[[a]])[2]<-
paste("rel",colnames(club3.real)[a],sep="_")
}
for (x in 2:13) {
relative.club3.real[[x+1]]<-left_join(relative.club3.real[[x]],relative.club3.real[[x+1]], by="Province")
}
table.relative.club3.real <- map(relative.club3.real, as.data.table)
df.relative.club3.real <- rbindlist(table.relative.club3.real, fill = T, idcol = T) %>% drop_na()
library(plyr)
df.relative.club3.real <- join(df.relative.club3.real,club3.real,by=c('Province')) %>%
select(Province,contains("rel"),Club)
df.relative.club3.real
colnames(df.relative.club3.real) <- gsub("rel_","",colnames(df.relative.club3.real))
df.relative.club3.real
df.relative.club3.real.long <- df.relative.club3.real %>%  pivot_longer(-c(Province,Club), names_to = "Time", values_to="Rel_Wage")
df.relative.club3.real.long
df.relative.club3.real.path <- aggregate(Rel_Wage ~ Province + Time, df.relative.club3.real.long, mean) %>%
arrange(Province)
c <- path_club3.real <- df.relative.club3.real.path %>%
ggplot(aes(x=Time,y=Rel_Wage, group=Province, col=Province)) + geom_line() +
labs(x = "Time",
y = "Relative transition paths of provinces in Club 3", color="") +
theme(text=element_text( family="Palatino")) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
path_club3.real
#ggsave("path_club3.real.png", width = 9, height = 5)
plotly(c)
ggplotly(c)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90))
ggsave("wage_quantile.png", width = 9, height = 5)
real.wage.long$Year <- as.factor(as.numeric(real.wage.long$Year))
prepare_trend_graph(real.wage.long, "Year", c("Wage"))$plot
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90))
ggsave("wage_quantile.png", width = 9, height = 5)
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
real.wage.long <- as.data.frame(real.wage.long)
real.wage.long$Year <- as.Date(as.factor(real.wage.long$Year), format = "%Y")
real.wage.long$Year <- as.factor(as.numeric(real.wage.long$Year))
prepare_trend_graph(real.wage.long, "Year", c("Wage"))$plot
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90))
ggsave("wage_quantile.png", width = 9, height = 5)
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
real.wage.long <- as.data.frame(real.wage.long)
real.wage.long$Year <- as.Date(as.factor(real.wage.long$Year), format = "%Y")
real.wage.long$Year <- as.factor(as.numeric(real.wage.long$Year))
prepare_trend_graph(real.wage.long, "Year", c("Wage"))$plot
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90))
ggsave("wage_quantile.png", width = 9, height = 5)
View(real.wage.long)
real.wage.long$Year <- as.factor(as.numeric(real.wage.long$Year))
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
df.long <- df %>%
pivot_longer(!c(Region, Province), names_to="Year", values_to="Wage")
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90))
ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90), size=7)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90))
ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90, size=7))
ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90, size=10))
ggsave("wage_quantile.png", width = 9, height = 5)
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
df <- real.wage %>%
select(-c(3:5)) %>%
subset(Province!="National")
library(ConvergenceClubs)
library(tidyverse)
library(janitor)
library(tibble)
library(data.table)
library(ExPanDaR)
df <- real.wage %>%
select(-c(3:5)) %>%
subset(Province!="National")
df
df.long <- df %>%
pivot_longer(!c(Region, Province), names_to="Year", values_to="Wage")
df.long$Year <- as.factor(df.long$Year)
df.long$Region_f = factor(df.long$Region, levels=c('Sumatra','Java','Bali-Nustra','Kalimantan', 'Sulawesi', 'Maluku-Papua'))
ggplot(df.long, aes(Year, Wage, group=Province)) + geom_line(size=0.3) +
facet_wrap(~Region_f) +
theme(
axis.text.x=element_text(angle=90,hjust=0.5, size=7),
axis.text.y=element_text(size=7),
panel.background = element_blank(),
axis.title=element_text(size=8),
strip.text = element_text(size=8)
) +
labs(y="Monthly real wage (000 IDR)", size=3)
ggsave("wage.plot.png")
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
real.wage.long <- as.data.frame(real.wage.long)
real.wage.long$Year <- as.Date(as.factor(real.wage.long$Year), format = "%Y")
real.wage.long$Year <- as.factor(as.numeric(real.wage.long$Year))
prepare_trend_graph(real.wage.long, "Year", c("Wage"))$plot
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
real.wage.long <- as.data.frame(real.wage.long)
real.wage.long$Year <- as.Date(as.factor(real.wage.long$Year), format = "%Y")
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90, size=10))
real.wage.long <- as.data.frame(real.wage.long)
real.wage.long$Year <- as.Date(as.factor(real.wage.long$Year), format = "%Y")
View(real.wage.long)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90, size=10))
real.wage.long$Year <- as.factor(as.numeric(real.wage.long$Year))
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
View(real.wage)
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
library(ConvergenceClubs)
library(tidyverse)
library(janitor)
library(tibble)
library(data.table)
library(ExPanDaR)
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
?prepare_quantile_trend_graph
graph <- prepare_quantile_trend_graph(real.wage.long[c("Year", "Wage")], "Year", c(0.05, 0.25, 0.5, 0.75, 0.95))
graph$plot
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + geom_line(aes(linetype=quantile)) theme(axis.text.x=element_text(angle=90, size=10))
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + geom_line(aes(linetype=quantile)) + theme(axis.text.x=element_text(angle=90, size=10))
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() +  theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme() +  theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_bw() +  theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_light() +  theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_minimal() +  theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() +  theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guide_legend(title="my awesome title") + theme(axis.text.x=element_text(angle=90, size=10))
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(fill=guide_legend(title="New Legend Title")) + theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() +  theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("my title")) + theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("Quantile")) + theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("Quantile")) + theme(axis.text.x=element_text(angle=90, size=10))
ggsave("wage_quantile.png", width = 9, height = 5)
df <- real.wage %>%
select(-c(3:5)) %>%
subset(Province!="National")
library(ConvergenceClubs)
library(tidyverse)
library(janitor)
library(tibble)
library(data.table)
library(ExPanDaR)
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
library(readxl)
real.wage <- read_excel("WS Labour_new.xlsx",
sheet = "real_wage_A")
real.wage
df <- real.wage %>%
select(-c(3:5)) %>%
subset(Province!="National")
df
real.wage <- real.wage %>%
select(-c(1,3:5)) %>%
subset(Province!="National")
real.wage.long <- real.wage %>%
pivot_longer(!Province, names_to="Year", values_to="Wage")
View(real.wage.long)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("Quantile")) + theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("Quantile")) +  scale_color_manual(labels = c("T999", "T888")) +
theme(axis.text.x=element_text(angle=90, size=10))
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("Quantile")) +  scale_color_manual(labels = c("5%","25%","50%","75%","95%")) +
theme(axis.text.x=element_text(angle=90, size=10))
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("Quantile")) +  scale_color_manual(labels = c("5%","25%","50%","75%","95%"), values = c("blue", "red"))) +
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("Quantile")) +  scale_color_manual(labels = c("5%","25%","50%","75%","95%"), values = c("blue", "red")) +
theme(axis.text.x=element_text(angle=90, size=10))
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("Quantile")) +  scale_color_manual(labels = c("5%","25%","50%","75%","95%"), values = c(0.05, 0.25, 0.5, 0.75, 0.95)) +
theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
prepare_quantile_trend_graph(real.wage.long, "Year", c(0.05, 0.25, 0.5, 0.75, 0.95), "Wage")$plot +
ggplot2::ylab("Real wage (000 IDR)") + scale_x_continuous(breaks = 2008:2020) +
theme_classic() + guides(color=guide_legend("Quantile")) + theme(axis.text.x=element_text(angle=90, size=10))
#ggsave("wage_quantile.png", width = 9, height = 5)
graph <- prepare_quantile_trend_graph(real.wage.long[c("Year", "Wage")], "Year", c(0.05, 0.25, 0.5, 0.75, 0.95))
graph$plot
library(geojsonsf)
library(sf)
sf_obj <- geojson_sf("https://gist.githubusercontent.com/haginta/22a1d27cf8ae440530758a5715f129c4/raw/1506205198c4337a6dbb6430b070fc24ba80e940/IDN_poly34_simple.JSON")
st_write(sf_obj, "sf_obj.shp")
IDNmap <- st_write(sf_obj, "sf_obj.shp")
st_write(sf_obj, "sf_obj.shp")
json_obj <- geojson_sf("IDN_poly34.json")
st_write(json_obj, "shp_obj.shp")
